<%
if(user){
%>
  <script type="text/javascript">
    window.User = <%-JSON.stringify(user)%>;
    window.onload = function(){
      var url = new URL(document.URL);
      var socket = new WebSocket("ws://"+url.hostname+":"+4180+"/poop");
    }
  </script>
  <h3>Hello <%=user.username%></h3>
  <a class="logout" href="/auth/logout">Logout</a>
<%
}else{
%>
  <script type="text/javascript">
    console.log("no user, so not creating a WebSocket.");
  </script>
  <h5>Login</h5>
  <ul><%
  var l = authTypes.length;
  while(l--){
    var provider = authTypes[l];
    %><li><%
    if(provider.html){
      %><%-provider.html%></li><%
      continue;
    }
    %><a class="login <%=provider.name%>" href="/auth/<%=provider.name%>/login" ><%
    if(provider.icon){
      %><img src='/auth/<%=provider.name%>/icon' title='Login with <%=provider.name%>' /><%
    }else{
      %><%=provider.name%><%
    }
    %></a></li><%
  }
%></ul><%
}
%>
